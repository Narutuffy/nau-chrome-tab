<template>
<div class="modal modal--slide-up">
	<h3 class="modal__title" i18n="settings">Settings</h3>
	<button class="modal__close icon-btn mdi mdi--close" @click="$emit('close')"></button>
	<div class="modal__content">
		<form id="settings-panel" class="modal__body settings">
			<fieldset>
				<legend>Choose language / Chọn ngôn ngữ</legend>
				<input id="setting-lang-en" type="radio" name="setting-language" value="en" v-model="language"><!--
			--><label class="settings__label" for="setting-lang-en">
					English
				</label>

				<input id="setting-lang-vi" type="radio" name="setting-language" value="vi" v-model="language"><!--
			--><label class="settings__label" for="setting-lang-vi">
					Tiếng Việt
				</label>
			</fieldset>
			<fieldset>
				<legend i18n="wallpaper_mode">Wallpaper Mode</legend>
				<input id="setting-wallpaper-mode-unsplash" type="radio" name="setting-wallpaper-mode" value="unsplash" v-model="wallpaperMode"><!--
			--><label class="settings__label" for="setting-wallpaper-mode-unsplash">
					Unsplash
				</label>

				<input id="setting-wallpaper-mode-user" type="radio" name="setting-wallpaper-mode" value="user" v-model="wallpaperMode"><!--
			--><label class="settings__label" for="setting-wallpaper-mode-user" i18n="your_photo">
					Your Photo
				</label>

				<label id="setting-photo-selector" class="u-hidden file-input settings__label">
					<input id="setting-photo-selector-input" type="file" class="u-hidden">
					<i class="mdi mdi--file-image"></i>
					<span id="setting-photo-selector-label" class="file-input__label">Choose a file</span>
				</label>

				<span id="selected-photo"></span>

			</fieldset>
			<fieldset id="setting-quicklinks">
				<legend i18n="quick_links">Quick Links</legend>
				<label title="https://mail.google.com" class="settings__label" ><input type="checkbox" value="gmail" v-model="quicklinks"> <i class="mdi mdi--gmail"></i> GMail</label>
				<label title="https://calendar.google.com" class="settings__label" ><input type="checkbox" value="gcalendar" v-model="quicklinks"> <i class="mdi mdi--calendar"></i> Google Calendar</label>
				<label title="https://drive.google.com" class="settings__label" ><input type="checkbox" value="gdrive" v-model="quicklinks"> <i class="mdi mdi--google-drive"></i> Google Drive</label>
				<label title="https://github.com" class="settings__label" ><input type="checkbox" value="github" v-model="quicklinks"> <i class="mdi mdi--github-circle"></i> Github</label>
				<label title="https://bitbucket.org" class="settings__label" ><input type="checkbox" value="bitbucket" v-model="quicklinks"> <i class="mdi mdi--bitbucket"></i> Bitbucket</label>
				<label title="https://trello.com" class="settings__label" ><input type="checkbox" value="trello" v-model="quicklinks"> <i class="mdi mdi--trello"></i> Trello</label>
				<label title="https://facebook.com" class="settings__label" ><input type="checkbox" value="facebook" v-model="quicklinks"> <i class="mdi mdi--facebook"></i> Facebook</label>
				<label title="https://twitter.com" class="settings__label" ><input type="checkbox" value="twitter" v-model="quicklinks"> <i class="mdi mdi--twitter"></i> Twitter</label>
				<label title="https://plus.google.com" class="settings__label" ><input type="checkbox" value="gplus" v-model="quicklinks"> <i class="mdi mdi--google-plus"></i> Google +</label>
				<label title="http://tuoitre.vn" class="settings__label"><input type="checkbox" value="tuoitre" v-model="quicklinks"> <span class="u-serif-text">tt</span> Tuoitre.vn</label>
				<label title="http://vnexpress.net/" class="settings__label"><input type="checkbox" value="vnexpress" v-model="quicklinks"> <span class="u-serif-text">vE</span> VNExpress</label>
				<label title="http://thanhnien.vn/" class="settings__label"><input type="checkbox" value="thanhnien" v-model="quicklinks"> <span class="u-serif-text">Tn</span> Thanhnien.vn</label>
				<label title="https://photos.google.com" class="settings__label" ><input type="checkbox" value="gphotos" v-model="quicklinks"> <i class="mdi mdi--image"></i> Google Photos</label>
				<label title="https://youtube.com" class="settings__label" ><input type="checkbox" value="youtube" v-model="quicklinks"> <i class="mdi mdi--youtube-play"></i> Youtube</label>
				<label title="https://jukebox.naustud.io" class="settings__label" ><input type="checkbox" value="naujukebox" v-model="quicklinks"> <i class="mdi mdi--play"></i> Nau Jukebox</label>
			</fieldset>
			<div class="copyright">
				<small>&copy; 2019 <a href="https://int3ractive.com">Thanh Tran</a>. <span i18n="oss_notice">Open source under Apache License v2.0</span>.</small>
				<a class="icon-btn" href="https://github.com/trongthanh/nau-chrome-tab" title="Source code on Github"><i class="mdi mdi--github-circle"></i></a><!--
				--><a class="icon-btn" href="https://chrome.google.com/webstore/detail/nau-tab/pimockeojlggmlnknhicajgckmlggifa?hl=en" title="Install this extension on Chrome Webstore"><i class="mdi mdi--google-chrome"></i></a>
			</div>
		</form>
	</div>
</div><!-- /.modal -->
</template>

<script>
/* © 2019 int3ractive.com
 * @author Thanh
 */
import Store from '../common/Store';

export default {
	name: 'SettingsModal',
	data() {
		const settings = Store.get('settings');
		const quicklinks = Object.keys(settings.activeQuicklinks).filter(linkName => settings.activeQuicklinks[linkName]);

		console.log('quicklinks', quicklinks);

		return {
			language: settings.language,
			wallpaperMode: settings.wallpaperMode,
			userPhotoName: settings.userPhotoName,
			quicklinks,
		};
	},
	methods: {},
	updated() {
		console.log('settings updated', this.language, this.wallpaperMode, this.quicklinks);
		const { language, wallpaperMode, userPhotoName, quicklinks } = this;
		// prettier-ignore
		const activeQuicklinks = ['gmail', 'gcalendar', 'gdrive', 'github', 'bitbucket', 'trello', 'facebook', 'twitter', 'gplus', 'tuoitre', 'vnexpress', 'thanhnien', 'gphotos', 'youtube', 'naujukebox']
			.reduce((obj, linkName) => {
				obj[linkName] = quicklinks.includes(linkName);

				return obj;
			}, {});

		const newSettings = {
			// these properties must be inside 'settings' due to legacy versions used them
			language,
			wallpaperMode,
			userPhotoName,
			activeQuicklinks,
		};

		Store.set('settings', newSettings);
	},
	created() {},
};
</script>

<style scoped>
/* empty */
</style>
